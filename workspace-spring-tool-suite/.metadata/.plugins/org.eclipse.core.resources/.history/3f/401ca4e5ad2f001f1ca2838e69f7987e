package com.team3.springProject.comment;

import java.util.List;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;

import ch.qos.logback.core.model.Model;
import jakarta.validation.Valid;
import lombok.RequiredArgsConstructor;

@Controller
public class CommentController {
	private final CommentService commentService;
	@GetMapping("/community")
	public String comment(Model model) {
		List<Comment> commentList = this.commentService.getComment();
		model.addAttribute("commentList", commentList);
		return "comment_list";
	}
	
	@GetMapping("/post/create")
	public String postCreate() {
		return "comment_form";
	}

	@PostMapping("/post/create")
	public String postCreate(
				@RequestParam(value="location") String location,
				@RequestParam(value="content") String content,
				@RequestParam(value="imageFile") MultipartFile imageFile) throws IOException {
		
		String imagePath = null;
		if (!imageFile.isEmpty()) {
			imagePath = saveImage(imageFile);
		}
		
		postService.createPost(location, content, imagePath);
		return "redirect:/community";
	}
}
